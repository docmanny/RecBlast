<h1 id="recblast">RecBlast</h1>
<p><a href="https://zenodo.org/badge/latestdoi/82135779"><img src="https://zenodo.org/badge/82135779.svg" alt="DOI" /></a>
Recblast is a module containing functions that can do Reciprocal-Best-Hit-BLAST
for a given list of sequences between a query species, and a list of target species.
Unlike other implementations of Reciprocal-Best-Hit-BLAST, RecBlast is designed to
be flexible in its functionality. Rather than simply identifying a lone reciprocal
best-hit, RecBlast compiles all hits above a set of given criteria in order of
descending scores, and then annotates them with a list of reciprocal BLAST hits
that were compiled and sorted in the same fashion.</p>

<p>Additionally, RecBlast is designed to be flexible in how it goes about performing
the searches; in its final form, RecBlast will be able to not only use BLAST,
but will also be able to use BLAT and other custom programs, either locally or
on remote servers.</p>

<p>(NOTE: As of the latest release, V1.0, RecBlastMP is the main module containing
the function recblastmp(), that can perform the Reciprocal-BLASTs in a
parallel fashion. Recblast.py should not be used, and instead,
RecBlastMP should be used with n_processes = 1 if one desires a
single-process version of the script.)</p>

<p><br /></p>

<h3 id="features"><strong><em>Features:</em></strong></h3>
<hr />
<ul>
  <li>Reciprocal BLASTs of any number of sequences between a query
species and any number of target species;</li>
  <li>Multiprocessing-enabled using Python’s multiprocessing module;</li>
  <li>Options for specifying or automatically selecting local databases to use at each step;</li>
  <li>Local or remote BLAST with customizable options.</li>
  <li>Sequence retrival from either FASTA or SQL databases (local-only as of V1.0).</li>
</ul>

<p><br /></p>

<h3 id="how-it-works"><strong><em>How it works:</em></strong></h3>
<hr />

<p>The script begins by initializing various RecBlast processes, one for each
RecBlast to be run, up to a mutable maximum limit. Once initialized, each RecBlast
process will then do the following:</p>

<ol>
  <li><strong>Forward BLAST</strong> of the given sequence against the target species BLAST database;</li>
  <li><strong>Filter hits</strong> based on given parameters;</li>
  <li><strong>Get the full-length sequences</strong> of all filtered hits;</li>
  <li><strong>Reverse BLAST</strong> each filtered hit against the query species BLAST database;</li>
  <li><strong>Filter reciprocal hits</strong> based on given parameters;</li>
  <li><strong>Annotate hits</strong> using the filtered, sorted reciprocal hits.</li>
</ol>

<p>The user can choose to either write all intermediate files to disk; write
only the final, annotated file to record; or to write nothing at all. The
program returns a RecBlastContainer object with all the intermediate outputs
stored within so that the user can inspect the results in memory after
running the program.</p>

<p><br /></p>

<h3 id="parameters-and-settings"><strong><em>Parameters and Settings:</em></strong></h3>
<hr />

<h5 id="forward-and-reverse-blast">Forward and Reverse BLAST</h5>

<p>The module has its own function, simply called blast(), that handles
the search functionality and calls to BLAST. In addition to being able
to specify whether to use a local BLAST installation or NCBI’s servers,
both the Forward and Reverse BLAST calls take a dictionary parameter,
fw_blast_kwargs and rv_blast_kwargs, respectively, that can be used to
modify the two searches independently.</p>

<p><br /></p>

<h3 id="roadmap"><strong><em>Roadmap:</em></strong></h3>
<hr />

<ul>
  <li>Entrez implementation for remote sequence searches</li>
  <li>Additional tools for analyzing output</li>
</ul>
